## 캐싱이란?

캐싱은 반복적인 데이터 접근 시, 기존 데이터를 메모리에 저장해두었다가 빠르게 다시 사용할 수 있도록 하는 기술로써
데이터를 데이터베이스나 원격 서버에서 매번 조회하지 않고 메모리 등 빠른 저장소에 임시로 보관했다가 빠르게 응답할 수 있다.

### 캐싱의 기대 효과
- 속도 향상: 응답 시간을 줄여 사용자 경험 개선
- 부하 감소: 데이터베이스 조회 빈도 감소로 서버 리소스 절약
- 절감: 서버 트래픽 감소로 인프라 비용 절감 가능

### 캐싱의 종류

캐싱은 구현 위치와 목적에 따라 다양한 종류로 분류되며, 각 캐싱 방법은 요구사항과 환경에 따라 적합한 선택을 하면 된다.
- 웹 브라우저 캐싱: 사용자 브라우저에 캐시 데이터 저장
- 웹 서버 캐싱: 웹 서버에서 정적 자원(이미지, CSS, JS 등) 캐싱
- 응용 프로그램 캐싱: 애플리케이션 레벨에서 데이터나 연산 결과 캐싱
- **데이터베이스 캐싱: 데이터베이스에서 쿼리 결과를 캐싱해 같은 요청에 빠르게 응답**

### 캐싱 전략
- Cache-Aside
  - 애플리케이션이 캐시를 직접 제어하여 캐시에 없으면 데이터베이스에서 데이터를 가져와 캐시에 저장합니다. 일반적으로 가장 많이 사용되는 방식.
  - 캐싱 라이프사이클을 유연하게 관리할 수 있다.
- Read-Through
  - 캐시에 없는 데이터를 데이터베이스에서 조회해 캐시에 저장 후 반환하는 방식.
  - 사용자는 항상 캐시에 접근하게 되어 응답 속도가 빨라진다.
- Write-Through
  - 데이터베이스와 캐시에 동시에 데이터를 쓰는 방식.
  - 데이터가 항상 일관성을 유지한다. 단, 쓰기 성능이 약간 저하될 수 있다.
- Write-Back
  - 캐시에 먼저 쓰고 일정 시간이 지난 후 데이터베이스로 반영하는 방식.
  - 쓰기 성능을 높일 수 있지만, 시스템 장애 시 데이터 유실 가능성이 있다.
- TTL
  - 데이터가 캐시에 얼마나 머무를지를 시간을 설정해 일정 시간이 지나면 삭제되도록 하는 방식.
  - 주기적으로 갱신이 필요한 데이터에 적합하다.

    
## 로컬 캐시 vs 글로벌 캐시
- 로컬 캐시
  - 설명
    - 애플리케이션 서버 내부에 위치한 캐시 (1차 캐시)
  - 특징
    - 서버 메모리에 직접 데이터를 저장해 해당 서버에만 접근 가능하다.
  - 장점
    - 애플리케이션 서버의 메모리를 사용하므로 네트워크 지연 없이 가장 빠르게 데이터에 접근할 수 있다.
    - 독립적으로 관리되므로 설정 및 운영이 간단하다.
  - 단점
    - 멀티 인스턴스 서버의 경우, 각 서버마다 독립적인 캐시로 관리되므로 데이터 일관성을 보장할 수 없다.
    - 서버 메모리를 사용하므로 캐시 용량이 제한적이다.
- 글로벌 캐시
  - 설명
    - 네트워크를 통해 여러 서버에서 공유하는 캐시(2차 캐시)로, Redis나 Memcached 같은 글로벌 캐시 서버를 사용한다.
  - 특징
    - 모든 애플리케이션 서버가 글로벌 캐시에 접근할 수 있다.
  - 장점
    - 모든 서버가 동일한 캐시에 접근하므로 데이터 일관성을 보장할 수 있다.
    - 캐시만을 위한 외부 서버가 존재하므로 대규모 데이터를 저장할 수 있다.
  - 단점
    - 서버간 통신이 필요하므로 네트워크 지연 발생할 수 있다.
    - 외부 캐시 서버가 필요하여 별도의 설정이 필요하다.

## Redis를 사용한 성능 개선

### Redis를 선택한 이유
1. 빠른 성능
    - Redis는 인메모리 기반으로 데이터를 처리하고, 조회 및 쓰기 성능이 뛰어나며 데이터베이스의 데이터를 캐싱해 보다 빠르게 응답할 수 있다.
2. 다양한 데이터 구조 지원 
   - Strings, JSON, Lists, Sets, Hashes, Sorted sets, Streams 등 다양한 데이터 구조를 지원한다.
3. TTL과 LRU 관리
   - Redis는 항목별로 TTL을 설정할 수 있어 일정 시간이 지나면 자동으로 삭제되도록 관리할 수 있다.
   - 메모리 관리 방식으로 LRU 방식을 지원해 캐시가 가득 차면 자주 사용되지 않은 데이터부터 삭제한다. 
4. 고가용성 지원 
   - Redis는 복제 및 클러스터링 기능을 지원하여 장애 발생 시 신속하게 복구할 수 있어 고가용성을 제공합니다.

## 콘서트 예약 시스템에서 적용할 부분

###  대기열

- 이유
  - 대기열 생성 후 발급된 토큰을 가지고 예약 시스템 전반에 사용이 되므로 자주 조회가 발생될 수 있다.
  - 따라서 대기열을 캐싱하여 빠른 읽기 속도를 제공해 DB 부하를 줄이고 트래픽 관리를 할 수 있도록 한다.
- 채택한 자료 구조
  - sorted sets
    - score에 만료시간을 timestamp로 저장해 시간이 작은 순서대로 정렬한다.
- 캐싱 전략
  - Cache-Aside

### 콘서트 정보 조회

- 이유
  - 콘서트 정보는 자주 바뀌지 않지만 자주 조회되는 데이터로서 캐싱에 적합하다.
  - 데이터 이격이 있어도 큰 무리가 없다.
  - 인기가 많은 콘서트의 경우 트래픽이 몰릴 수 있기 때문에 캐싱 웜업을 통한 트래픽 관리를 할 수 있을 것으로 기대한다.
- 채택한 자료 구조
  - JSON
    - 복잡한 계층의 데이터를 관리하기 용이하다.
- 캐싱 전략
  - Cache-Aside